var $jscomp={scope:{},findInternal:function(d,p,h){d instanceof String&&(d=String(d));for(var t=d.length,v=0;v<t;v++){var m=d[v];if(p.call(h,m,v,d))return{i:v,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,p,h){if(h.get||h.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[p]=h.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,p,h,t){if(p){h=$jscomp.global;d=d.split(".");for(t=0;t<d.length-1;t++){var v=d[t];v in h||(h[v]={});h=h[v]}d=d[d.length-1];t=h[d];p=p(t);p!=t&&null!=p&&$jscomp.defineProperty(h,d,{configurable:!0,writable:!0,value:p})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,h){return $jscomp.findInternal(this,d,h).v}},"es6-impl","es3");
(function(d){"function"===typeof define&&define.amd?define(["jquery","./grid.base"],d):"object"===typeof exports?d(require("jquery")):d(jQuery)})(function(d){var p=d.jgrid,h=p.getAccessor,t=p.stripPref,v=p.jqID,m=d.fn.jqGrid,x=function(){var b=d.makeArray(arguments);b[0]="treeGrid"+b[0].charAt(0).toUpperCase()+b[0].substring(1);b.unshift("");b.unshift("");b.unshift(this.p);return p.feedback.apply(this,b)};p.extend({setTreeNode:function(){return this.each(function(){var b=d(this),a=this.p;if(this.grid&&
a.treeGrid){var c=a.treeReader.expanded_field,g=a.treeReader.leaf_field;b.unbind("jqGridBeforeSelectRow.setTreeNode");b.bind("jqGridBeforeSelectRow.setTreeNode",function(e,k,f){if(null!=f){e=d(f.target);f=e.closest("tr.jqgrow>td");var l=f.parent(),r=function(){var d=a.data[a._index[t(a.idPrefix,k)]],f=d[c]?"collapse":"expand";d[g]||(m[f+"Row"].call(b,d,l),m[f+"Node"].call(b,d,l))};e.is("div.treeclick")?r():a.ExpandColClick&&0<f.length&&0<e.closest("span.cell-wrapper",f).length&&r();return!0}})}})},
setTreeGrid:function(){return this.each(function(){var b=this.p,a,c,g,e=[],k=["leaf_field","expanded_field","loaded"];if(b.treeGrid){b.treedatatype||d.extend(this.p,{treedatatype:b.datatype});b.subGrid=!1;b.altRows=!1;b.pgbuttons=!1;b.pginput=!1;b.gridview=!0;null===b.rowTotal&&(b.rowNum=b.maxRowNum);b.rowList=[];b.treeIcons.plus="rtl"===b.direction?b.treeIcons.plusRtl:b.treeIcons.plusLtr;"nested"===b.treeGridModel?b.treeReader=d.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",
expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},b.treeReader):"adjacency"===b.treeGridModel&&(b.treeReader=d.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},b.treeReader));for(c in b.colModel)if(b.colModel.hasOwnProperty(c))for(g in a=b.colModel[c].name,b.treeReader)b.treeReader.hasOwnProperty(g)&&b.treeReader[g]===a&&e.push(a);d.each(b.treeReader,function(a){var c=String(this);c&&-1===d.inArray(c,e)&&
(0<=d.inArray(a,k)?b.additionalProperties.push({name:c,search:!1,convert:function(a){return!0===a||"true"===String(a).toLowerCase()||"1"===String(a)?!0:a}}):b.additionalProperties.push(c))})}})},expandRow:function(b){this.each(function(){var a=d(this),c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.expanded_field,e=b[c.localReader.id];if(x.call(this,"beforeExpandRow",{rowid:e,item:b})){var k=m.getNodeChildren.call(a,b);d(k).each(function(){var b=c.idPrefix+h(this,c.localReader.id);d(m.getGridRowById.call(a,
b)).css("display","");this[g]&&m.expandRow.call(a,this)});x.call(this,"afterExpandRow",{rowid:e,item:b})}}})},collapseRow:function(b){this.each(function(){var a=d(this),c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.expanded_field,e=b[c.localReader.id];if(x.call(this,"beforeCollapseRow",{rowid:e,item:b})){var k=m.getNodeChildren.call(a,b);d(k).each(function(){var b=c.idPrefix+h(this,c.localReader.id);d(m.getGridRowById.call(a,b)).css("display","none");this[g]&&m.collapseRow.call(a,this)});
x.call(this,"afterCollapseRow",{rowid:e,item:b})}}})},getRootNodes:function(){var b=[];this.each(function(){var a=this.p;if(this.grid&&a.treeGrid)switch(a.treeGridModel){case "nested":var c=a.treeReader.level_field;d(a.data).each(function(){parseInt(this[c],10)===parseInt(a.tree_root_level,10)&&b.push(this)});break;case "adjacency":var g=a.treeReader.parent_id_field;d(a.data).each(function(){null!==this[g]&&"null"!==String(this[g]).toLowerCase()||b.push(this)})}});return b},getNodeDepth:function(b){var a=
null;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":a=parseInt(b[c.treeReader.level_field],10)-parseInt(c.tree_root_level,10);break;case "adjacency":a=m.getNodeAncestors.call(d(this),b).length}});return a},getNodeParent:function(b){var a=this[0];if(!a||!a.grid||null==a.p||!a.p.treeGrid||null==b)return null;var a=a.p,c=a.treeReader,g=b[c.parent_id_field];if("nested"===a.treeGridModel){var e=null,k=c.left_field,f=c.right_field,l=c.level_field,r=parseInt(b[k],
10),m=parseInt(b[f],10),n=parseInt(b[l],10);d(a.data).each(function(){if(parseInt(this[l],10)===n-1&&parseInt(this[k],10)<r&&parseInt(this[f],10)>m)return e=this,!1});return e}if(null===g||"null"===g)return null;b=a._index[g];return void 0!==b?a.data[b]:null},getNodeChildren:function(b){var a=[];this.each(function(){var c=this.p;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":var g=c.treeReader.left_field,e=c.treeReader.right_field,k=c.treeReader.level_field,f=parseInt(b[g],10),l=parseInt(b[e],
10),r=parseInt(b[k],10);d(c.data).each(function(){parseInt(this[k],10)===r+1&&parseInt(this[g],10)>f&&parseInt(this[e],10)<l&&a.push(this)});break;case "adjacency":var m=c.treeReader.parent_id_field,n=c.localReader.id;d(c.data).each(function(){String(this[m])===String(b[n])&&a.push(this)})}});return a},getFullTreeNode:function(b){var a=[];this.each(function(){var c=this.p,g;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":var e=c.treeReader.left_field,k=c.treeReader.right_field,f=c.treeReader.level_field,
l=parseInt(b[e],10),m=parseInt(b[k],10),p=parseInt(b[f],10);d(c.data).each(function(){parseInt(this[f],10)>=p&&parseInt(this[e],10)>=l&&parseInt(this[e],10)<=m&&a.push(this)});break;case "adjacency":if(b){a.push(b);var n=c.treeReader.parent_id_field,h=c.localReader.id;d(c.data).each(function(){var b;g=a.length;for(b=0;b<g;b++)if(String(a[b][h])===String(this[n])){a.push(this);break}})}}});return a},getNodeAncestors:function(b){var a=[];this.each(function(){var c=d(this),g=m.getNodeParent;if(this.grid&&
this.p.treeGrid)for(var e=g.call(c,b);e;)a.push(e),e=g.call(c,e)});return a},isVisibleNode:function(b){var a=!0;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid){var g=m.getNodeAncestors.call(d(this),b),e=c.treeReader.expanded_field;d(g).each(function(){a=a&&this[e];if(!a)return!1})}});return a},isNodeLoaded:function(b){var a;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.leaf_field,c=c.treeReader.loaded;a=void 0!==b?void 0!==b[c]?b[c]:b[g]||0<m.getNodeChildren.call(d(this),
b).length?!0:!1:!1}});return a},expandNode:function(b){return this.each(function(){var a=this.p;if(this.grid&&a.treeGrid){var c=a.treeReader.expanded_field,g=a.treeReader.parent_id_field,e=a.treeReader.loaded,k=a.treeReader.level_field,f=a.treeReader.left_field,l=a.treeReader.right_field;if(!b[c]){var r=h(b,a.localReader.id);if(x.call(this,"beforeExpandNode",{rowid:r,item:b})){var p=d("#"+a.idPrefix+v(r),this.grid.bDiv)[0],n=a._index[r];"local"===a.treedatatype||m.isNodeLoaded.call(d(this),a.data[n])?
(b[c]=!0,d("div.treeclick",p).removeClass(a.treeIcons.plus+" tree-plus").addClass(a.treeIcons.commonIconClass).addClass(a.treeIcons.minus+" tree-minus")):this.grid.hDiv.loading||(b[c]=!0,d("div.treeclick",p).removeClass(a.treeIcons.plus+" tree-plus").addClass(a.treeIcons.commonIconClass).addClass(a.treeIcons.minus+" tree-minus"),a.treeANode=p.rowIndex,a.datatype=a.treedatatype,m.setGridParam.call(d(this),{postData:"nested"===a.treeGridModel?{nodeid:r,n_level:b[k],n_left:b[f],n_right:b[l]}:{nodeid:r,
n_level:b[k],parentid:b[g]}}),d(this).trigger("reloadGrid"),b[e]=!0,m.setGridParam.call(d(this),{postData:"nested"===a.treeGridModel?{nodeid:"",n_level:"",n_left:"",n_right:""}:{nodeid:"",n_level:"",parentid:""}}));x.call(this,"afterExpandNode",{rowid:r,item:b})}}}})},collapseNode:function(b){return this.each(function(){var a=this.p;if(this.grid&&a.treeGrid){var c=a.treeReader.expanded_field;if(b[c]){var g=h(b,a.localReader.id);x.call(this,"beforeCollapseNode",{rowid:g,item:b})&&(b[c]=!1,c=d("#"+
a.idPrefix+v(g),this.grid.bDiv)[0],d("div.treeclick",c).removeClass(a.treeIcons.minus+" tree-minus").addClass(a.treeIcons.commonIconClass).addClass(a.treeIcons.plus+" tree-plus"),x.call(this,"afterCollapseNode",{rowid:g,item:b}))}}})},SortTree:function(b,a,c,g){return this.each(function(){var e=this,k=e.p,f=d(e);if(e.grid&&k.treeGrid){var l,r,D,n=[];l=m.getRootNodes.call(f);l=p.from.call(e,l);l.orderBy(b,a,c,g);var t=l.select();l=0;for(r=t.length;l<r;l++)D=t[l],n.push(D),m.collectChildrenSortTree.call(f,
n,D,b,a,c,g);d.each(n,function(a){var b=h(this,k.localReader.id);d(e.rows[a]).after(f.find(">tbody>tr#"+v(b)))})}})},collectChildrenSortTree:function(b,a,c,g,e,k){return this.each(function(){var f=d(this);if(this.grid&&this.p.treeGrid){var l,r,h;l=m.getNodeChildren.call(f,a);l=p.from.call(this,l);l.orderBy(c,g,e,k);var n=l.select();l=0;for(r=n.length;l<r;l++)h=n[l],b.push(h),m.collectChildrenSortTree.call(f,b,h,c,g,e,k)}})},setTreeRow:function(b,a){var c=!1;this.each(function(){this.grid&&this.p.treeGrid&&
(c=m.setRowData.call(d(this),b,a))});return c},delTreeNode:function(b){return this.each(function(){var a=this.p,c,g,e,k;e=a.localReader.id;var f,l=d(this),r=a.treeReader.left_field,h=a.treeReader.right_field;if(this.grid&&a.treeGrid&&(f=a._index[b],void 0!==f)){c=parseInt(a.data[f][h],10);g=c-parseInt(a.data[f][r],10)+1;var n=m.getFullTreeNode.call(l,a.data[f]);if(0<n.length)for(f=0;f<n.length;f++)m.delRowData.call(l,n[f][e]);if("nested"===a.treeGridModel){e=p.from.call(this,a.data).greater(r,c,{stype:"integer"}).select();
if(e.length)for(k in e)e.hasOwnProperty(k)&&(e[k][r]=parseInt(e[k][r],10)-g);e=p.from.call(this,a.data).greater(h,c,{stype:"integer"}).select();if(e.length)for(k in e)e.hasOwnProperty(k)&&(e[k][h]=parseInt(e[k][h],10)-g)}}})},addChildNode:function(b,a,c,g){var e=d(this),k=e[0],f=k.p,l=m.getInd;if(c){var h,t,n,v,y;h=0;var x=a,E,w,B=f.treeReader.expanded_field;w=f.treeReader.leaf_field;var q=f.treeReader.level_field,K=f.treeReader.parent_id_field,A=f.treeReader.left_field,z=f.treeReader.right_field,
F=f.treeReader.loaded;void 0===g&&(g=!1);if(null==b){y=f.data.length-1;if(0<=y)for(;0<=y;)h=Math.max(h,parseInt(f.data[y][f.localReader.id],10)),y--;b=h+1}var J=l.call(e,a);E=!1;if(void 0===a||null===a||""===a)x=a=null,h="last",v=f.tree_root_level,y=f.data.length+1;else{h="after";t=f._index[a];n=f.data[t];a=n[f.localReader.id];y=l.call(e,a);v=parseInt(n[q],10)+1;var G=m.getFullTreeNode.call(e,n);if(G.length){var C,H,I;for(C=0;C<G.length;C++)I=G[C][f.localReader.id],H=l.call(e,I),H>y&&(y=H,x=I)}y++;
n[w]&&(E=!0,n[B]=!0,d(k.rows[J]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(f.treeIcons.leaf+" tree-leaf").addClass(f.treeIcons.commonIconClass).addClass(f.treeIcons.minus+" tree-minus"),f.data[t][w]=!1,n[F]=!0)}l=y+1;void 0===c[B]&&(c[B]=!1);void 0===c[F]&&(c[F]=!1);c[q]=v;void 0===c[w]&&(c[w]=!0);"adjacency"===f.treeGridModel&&(c[K]=a);if("nested"===f.treeGridModel){var u;if(null!==a){w=parseInt(n[z],10);f=p.from.call(k,
f.data);f=f.greaterOrEquals(z,w,{stype:"integer"});q=f.select();if(q.length)for(u in q)q.hasOwnProperty(u)&&(q[u][A]=q[u][A]>w?parseInt(q[u][A],10)+2:q[u][A],q[u][z]=q[u][z]>=w?parseInt(q[u][z],10)+2:q[u][z]);c[A]=w;c[z]=w+1}else{w=parseInt(m.getCol.call(e,z,!1,"max"),10);q=p.from.call(k,f.data).greater(A,w,{stype:"integer"}).select();if(q.length)for(u in q)q.hasOwnProperty(u)&&(q[u][A]=parseInt(q[u][A],10)+2);q=p.from.call(k,f.data).greater(z,w,{stype:"integer"}).select();if(q.length)for(u in q)q.hasOwnProperty(u)&&
(q[u][z]=parseInt(q[u][z],10)+2);c[A]=w+1;c[z]=w+2}}if(null===a||m.isNodeLoaded.call(e,n)||E)m.addRowData.call(e,b,c,h,x),m.setTreeNode.call(e,y,l);n&&!n[B]&&g&&d(k.rows[J]).find("div.treeclick").click()}}})});
//# sourceMappingURL=grid.treegrid.map
